/Users/user/eclipse.platform.ui/bundles/org.eclipse.ui.navigator/src/org/eclipse/ui/internal/navigator/extensions/EvaluationCache.java
org eclipse internal navigator extensions java lang reference java lang reference queue java util hash map java util map org eclipse internal navigator visibility assistant org eclipse internal navigator visibility assistant visibility listener cache evaluated link navigator content descriptor evaluation cache visibility listener have cache max size soft references prevent pathological performance happen large number softly reachable objects helping reduce dependence keeping cache size place counters cache hits misses replacements either overrides overrides share parts data structures map key pair maps bother tracking overrides users handle instances map evaluation reference object evaluation value reference navigator content descriptor evaluations hash map map evaluation reference object evaluation value reference navigator content descriptor evaluations with overrides hash map reference queue object evaluations queue reference queue reference queue object evaluations with overrides queue reference queue param assistant visisbility assistant register null evaluation cache visibility assistant assistant assistant add listener clean stale entries only clean number entries call accessing setting periodic task ala org eclipse core runtime jobs job thread safe not thread safe isn fine reference reference poll thankfully block evaluations queue poll null process stale entry evaluations evaluations with overrides queue poll null process stale entry evaluations with overrides process stale entry reference map reference reference map evaluation reference key collected clear entry evaluation value reference val evaluation value reference map remove val null clear key don prematurely remove potential mapping clean stale entries val clear evaluation value reference collected key remove entry evaluation reference key evaluation value reference key key null map remove key all reference types leave navigator content descriptor descriptors from map object element map evaluation reference object evaluation value reference navigator content descriptor map need wrap reference type querying won hash map evaluation reference object key evaluation reference element navigator content descriptor cached descriptors null reference navigator content descriptor cache map key cache null cached descriptors cache null there entry collected remove stale mapping evaluation value reference navigator content descriptor map remove key null clear key don prematurely remove potential mapping clean stale entries clear cached descriptors finds cached descriptors key returns code null cache param element key lookup param compute overrides overrides considered cached descriptors key code null cache navigator content descriptor descriptors object element compute overrides clean stale entries element null null compute overrides descriptors from map element evaluations descriptors from map element evaluations with overrides set descriptors map object element navigator content descriptor descriptors map evaluation reference object evaluation value reference navigator content descriptor map reference queue object queue ideally weak reference wrapper object identity equality test object equals override soft reference object overrides equals bit unwieldy check require checking reflective data worth evaluation reference object key evaluation reference element queue evaluation value reference navigator content descriptor value evaluation value reference descriptors key queue evaluation value reference navigator content descriptor value map key value value null swap correct key instance swapping temporary lookup key collected early actual element reference object not needed point field waste value swap key value clear key don prematurely remove mapping clean stale entries value clear caches descriptors key param element key associate descriptors param descriptors descriptors cache key param compute overrides overrides considered computation descriptors set descriptors object element navigator content descriptor descriptors compute overrides clean stale entries element null compute overrides set descriptors map element descriptors evaluations evaluations queue set descriptors map element descriptors evaluations with overrides evaluations with overrides queue inherit doc for evaluation cache invalidating cached descriptors override visibility activation change clear clears cache clear reference queue don evaluations queue poll null reference drain queue evaluations with overrides queue poll null reference drain queue evaluations clear evaluations with overrides clear