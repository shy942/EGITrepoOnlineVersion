/Users/user/eclipse.platform.ui/bundles/org.eclipse.core.databinding.observable/src/org/eclipse/core/databinding/observable/list/ComputedList.java
org eclipse core databinding observable list java util array list java util collections java util list org eclipse core databinding observable change event org eclipse core databinding observable diffs org eclipse core databinding observable change listener org eclipse core databinding observable observable org eclipse core databinding observable stale listener org eclipse core databinding observable observable tracker org eclipse core databinding observable realm org eclipse core databinding observable stale event org eclipse core databinding observable observable value lazily calculated list automatically computes registers listeners dependencies dependencies link observable objects any change observable dependencies list recomputed this thread safe all accessing methods invoked link realm current current realm methods adding removing listeners invoked thread example compute fibonacci sequence elements link observable value link integer pre observable value count writable value value type integer count set value integer observable list fibonacci computed list list calculate size integer count value value list result array list size result add integer result add integer integer left integer result integer integer result result add integer left value value result system println fibonacci quot quot count set value integer system println fibonacci quot quot pre param list element type computed list abstract observable list list cached list array list dirty true stale false observable dependencies observable creates computed list realm unknown null element type computed list realm default null creates computed list realm element type param element type element type code null code unknown element type computed list object element type realm default element type creates computed list realm unknown null element type param realm realm computed list realm realm realm null creates computed list realm element type param realm realm param element type element type code null code unknown element type computed list realm realm object element type realm element type element type inner interfaces don expose each implemented separate anonymous combine reduce memory overhead number classes runnable calls calculate stores result cached list change listener stores observable dependencies list this registered listener calling observable tracker detect observable compute value change listener attached dependency private interface runnable change listener stale listener override cached list calculate cached list null cached list collections override handle stale stale event event dirty stale override handle change change event event dirty private interface interface private interface object element type override get size get list size override getter called get list list list getter called get list list get list dirty this run calculate method while add observable touched dependencies list observable dependencies observable tracker and monitor interface interface null dependencies stale stale event fired stale recomputing this clients assume list change indicative staleness stale false dependencies length dependencies stale stale stale dependencies length dependencies add stale listener interface dependencies dependencies dirty false cached list getter called observable tracker getter called subclasses override method calculate list contents any dependencies calculate list link observable implementers methods tagged tracked getter computed list recognize dependency object list list calculate dirty dirty dirty true stale listening copy list list list array list cached list fire dirty event this implementation recomputes list lazily fire list change list diff list list diff entry differences override list diff entry differences differences null diffs compute list diff list list differences differences array list diff entry differences size listening dependencies null dependencies length observable observable dependencies observable remove change listener interface observable remove stale listener interface dependencies null stale stale stale true fire stale override stale recalculate list dirty ensure staleness correct list stale override object element type element type override add change listener change listener listener add change listener listener listening attach listeners compute list for listeners override add list change listener list change listener listener add list change listener listener listening attach listeners compute list for listeners compute list for listeners some clients add listener expect notified called value call value need careful realms method called realm see bug client calls realm receive change notifications runnable executed job figure notifications realm exec runnable override dependencies null listening but listening call value start listening observables depend list override dispose listening dispose